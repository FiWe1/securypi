{% extends 'base.html' %}
{% block head %}
  <!-- <script>
    window.addEventListener("beforeunload", function () {
      // Send a background POST request when the user leaves the page
      navigator.sendBeacon("/stop_camera");
    });
</script> -->
{% endblock %}

{% block body_header %}
  <h1>{% block title %}Your Home{% endblock %}</h1>
{% endblock %}

{% block body_content %}
  <section class="camera_overview">
    {% set switch_mode = 'picture' if mode == 'stream' else 'stream' %}
    <a href="{{ url_for('overview.index', mode=switch_mode) }}" class="button-style-link">
      Switch to {{ switch_mode|capitalize }} Mode
    </a>
    <p>Currently viewing {{ "Live Stream" if mode == "stream" else "Snapshot" }}</p>
    
    <img id="camera_feed" src="{{ img_src }}" width="640" height="480" />

    {% if mode == 'picture' %}
      <button onclick="document.getElementById('camera_feed').src = '{{ img_src }}?' + new Date().getTime()">Refresh Snapshot</button>
    {% endif %}
  </section>

  <section class="temphum">
    <h2>Temperature and Humidity</h2>
    <p>Temperature: {{ temperature }} &deg;{{ temperature_unit }}</p>
    <p>Humidity: {{ humidity }} %</p>
  </section>
{% endblock %}
